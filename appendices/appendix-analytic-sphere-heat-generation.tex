\section{Sphere with heat generation}\label{sec:analytic-sphere-details}

We solve for the temperature distribution inside a single sphere of constant thermal conductivity with constant heat generation with a convective heat transfer boundary condition. To simplify to homogeneous boundary conditions, the temperature we solve for will be in reference to the fluid temperature, $\mathbb{T} = T-T_f$. 

The energy equation in spherical coordinates with axial symmetry is,

\begin{equation}
    \frac{1}{r}\frac{\partial^2}{\partial r^2}(r\mathbb{T}) + \frac{g}{k} = \frac{1}{\alpha}\frac{\partial \mathbb{T}}{\partial t}
\end{equation}

which is subject to the boundary conditions of a constant heat transfer coefficient at the surface, $h$,

\begin{equation}
    \left[\frac{\partial \mathbb{T}}{\partial r} + \frac{h}{k}\mathbb{T}\right]_{r=b} = 0
\end{equation}

and an axisymmetry at the center,

\begin{equation}
    \left[\frac{\partial \mathbb{T}}{\partial r}\right]_{r=0} = 0
\end{equation}

The sphere will be at an isothermal initial temperature,

\begin{equation}
    \mathbb{T}(r,0) = \mathbb{T}_0
\end{equation}





\subsection{Transformations}

We first transform the system into the nondimensional forms as defined in \S\ref{sec:ht-jeffreson-correction},

\begin{align*}
    \theta &= \frac{\mathbb{T}}{\mathbb{T}_0}\\
    \rho & = \frac{r}{b}\\
    \tau & = \frac{t}{b^2/\alpha}
\end{align*}

The energy equation is then,
\begin{equation}
    \frac{1}{\rho}\frac{\partial^2}{\partial \rho^2}(\rho\theta) + G = \frac{\partial\theta}{\partial \tau}
\end{equation}

where $G = \frac{gb^2}{k\mathbb{T}_0}$

The next transformation will be to introduce $U(\rho,\tau) = \rho\theta(\rho,\tau)$ as a transformation variable to simplify the differential equation of energy conservation. In the new variable formulation, the energy equation is,

\begin{equation}\label{eq:transformed-energy}
    \frac{\partial^2 U}{\partial \rho^2} + G\rho = \frac{\partial U}{\partial \tau}
\end{equation}

The boundary conditions are likewise transformed into,

\begin{equation}\label{eq:transformed-bc-1}
    \left[\frac{\partial U}{\partial \rho} + \left(\Bi-1\right)U\right]_{\rho = 1}= 0
\end{equation}

and

\begin{equation}\label{eq:transformed-bc-2}
    U\big|_{\rho=0} = 0
\end{equation}

with initial condition

\begin{equation}\label{eq:transformed-ic}
    U(\rho,0) = U_0 = \theta_0 r^* = r^*
\end{equation}




\subsection{Solution}

Because of the non-homegeneous form of the energy equation (due to the heat generation term), we will solve Eq.~\ref{eq:transformed-energy} by breaking it up into two simpler problems, 

\begin{enumerate}
\item A non-homogeneous, steady-state problem defined by $U_{ss}(r)$
\item A homogeneous, time-dependent problem defined by $U_h(r,t)$
\end{enumerate}

The steady-state distribution $U_{ss}$ is found from the solution of

\begin{equation}
    \frac{\partial^2 U_{ss}}{\partial \rho^2} + G\rho= 0
\end{equation}

subject to the same boundary condition given by Eqs.~\ref{eq:transformed-bc-1},\ref{eq:transformed-bc-2}. Separation and integration gives.

\begin{equation}
    U_{ss} = -\frac{G}{6} \rho^3 + C_1\rho + C_2
\end{equation}

Applying Eq.~\ref{eq:transformed-bc-2} directly gives $C_2 = 0$ and, with some algebra Eq.~\ref{eq:transformed-bc-1} gives, 

\begin{equation*}
    C_1 = \left(\frac{G}{6} + \frac{G}{3\Bi}\right)
\end{equation*}

valid for $\Bi > 0$. Thus the steady-state distribution of our transformed variable is

\begin{equation}\label{eq:transformed-steady-state-solution}
    U_{ss} = \left(\frac{G}{6} + \frac{G}{3\Bi}-\rho^2\right)\rho
\end{equation}

The next step is to find the homogeneous solution of 

\begin{equation}
    \frac{\partial^2 U_h}{\partial \rho^2} = \frac{\partial U_h}{\partial \tau}
\end{equation}

Again, subject to Eqs.~\ref{eq:transformed-bc-1},\ref{eq:transformed-bc-2}, but now with a modified initial condition of 

\begin{align}\label{eq:homogeneous-ic}
    U_{h,0} &= U_0 - U_{ss} \nonumber \\
    & = \left[1 - \left(\frac{G}{6} + \frac{G}{3\Bi}-\rho^2\right) \right]\rho
\end{align}

This is a standard homogeneous partial differntial equation. The solution is of the form

\begin{equation}
    U_h = R(\rho) \Gamma(\tau)
\end{equation}

The solution for $\Gamma$ is given as

\begin{equation}
    \Gamma = \exp(-\zeta^2 \tau)
\end{equation}

The space-variable function $R(\zeta,\rho)$ satisfies the following eigenvalue problem:

\begin{equation}\label{eq:eigen-function}
    \frac{\mathrm{d}^2R}{\mathrm{d}\rho^{2}} + \zeta^2 R = 0
\end{equation}

subject to 

\begin{equation}
    R_{\rho = 0} = 0
\end{equation}

and

\begin{equation}
    \left[\frac{\mathrm{d}R}{\mathrm{d}\rho} + (\Bi - 1)R\right]_{\rho=1} = 0
\end{equation}

This eigenvalue problem is a special case of the Sturm-Liouville problem. The solution for $U_h$ can be constructed from known eigenvalue solutions,

\begin{equation}\label{eq:eigen-general-solution}
    U_h(\rho,\tau) = \sum_{n=1}^\infty c_n R(\zeta_n,\rho)\exp(-\zeta^2 \tau)
\end{equation}

Application of the initial condition gives,

\begin{equation}\label{eq:eigen-initial-condition}
    F(\rho) = \sum_{n=1}^\infty c_n R(\zeta_n,\rho)
\end{equation}

where $F(\rho)$ is the initial condition defined from Eq~\ref{eq:transformed-ic}, 

\begin{equation}
    F(\rho) =\left[1 - \frac{G}{6}\left(1 + \frac{2}{\Bi}-\rho^2\right) \right]\rho
\end{equation}

The coefficients of $c_n$ can be determined by applying the operator $\int_0^1 R(\zeta_n,\rho)\,\mathrm{d}\rho$ and utilizing the orthogonality property of eigenfunctions. The coefficients are found in the form

\begin{equation}\label{eq:eigenfunction-coefficients}
    c_n = \frac{1}{N(\zeta_n)}\int_0^1 R(\zeta_n,\rho')F(\rho')\,\mathrm{d}\rho'
\end{equation}

The norm, $N$ is a function of the eigenvalues,

\begin{equation}
    N(\zeta_n) = \int_0^1 \left[R(\zeta_n,\rho)\right]^2\,\mathrm{d}\rho
\end{equation}

% Eq.~\ref{eq:eigenfunction-coefficients} is also inserted back into Eq.~\ref{eq:eigen-initial-condition},

% \begin{equation}
%     (T_0-T_f)r - \frac{g}{6k} r^3 - \frac{gb^2}{6k}\left(1 + \frac{2}{Bi}\right)r = \sum_{n=1}^\infty \frac{R(\zeta_n,r)}{N(\zeta_n)}\int_0^b R(\zeta_n,r')F(r')\,\mathrm{d}r'
% \end{equation}

The eigenfunctions for Eq.~\ref{eq:eigen-function} are

\begin{equation}
    R(\zeta_n,\rho) = \sin(\zeta_n \rho)
\end{equation}

where the eigenvalues are the root of the following transcendental equation,

\begin{equation}
    \zeta_n\cot(\zeta_n) = -H
\end{equation}

the roots of which will be found numerically. The normalization integral is then solved as

\begin{equation}
    \frac{1}{N(\zeta_n)} = 2\frac{\zeta_n^2 + H^2}{\zeta_n^2+H^2 + H}
\end{equation}

where $H = (\Bi-1)$. 

We substitute the coefficients of Eq.~\ref{eq:eigenfunction-coefficients}, they can be substituted back into Eq.~\ref{eq:eigen-general-solution} and we have a solution for the homogeneous, transient distribution,

\begin{equation}
    U_h(\rho,\tau) = \sum_{n=1}^\infty \exp(-\zeta^2 \tau) \frac{R(\zeta_n,\rho)}{N(\zeta_n)}\int_0^1 R(\zeta_n,\rho')F(\rho')\,\mathrm{d}\rho'
\end{equation}

In order to explicitly express the solution, we will first set the integral equal to a function $Z(\zeta_n)$ and evaluate as,

\begin{align}
    Z(\zeta_n) & = \int_0^1 R(\zeta_n,\rho')F(\rho')\,\mathrm{d}\rho' \nonumber\\
    & = \int_0^1\sin(\zeta_n\rho') \left[1 - \left(\frac{G}{6} + \frac{G}{3\Bi}-\rho^{'2}\right) \right]\rho'  \,\mathrm{d}\rho' \nonumber\\
    & =\left[1  - \left(\frac{G}{6} + \frac{G}{3\Bi}\right)\right]\int_0^1\sin(\zeta_n\rho')\rho' \,\mathrm{d}\rho' + \frac{G}{6}\int_0^1 \sin(\zeta_n\rho')\rho^{'3} \,\mathrm{d}\rho'
\end{align}

The two unique integrals are evaluated as

\begin{align*}
    C_n &= \int_0^1\sin(\zeta_n\rho')\rho' \,\mathrm{d}\rho'  = \frac{\sin\zeta_n-\zeta_n\cos\zeta_n}{\zeta_n^2}\\
    K_n &= \int_0^1\sin(\zeta_n\rho')\rho^{'3} \,\mathrm{d}\rho'  = \frac{3(\zeta_n^2-2)\sin\zeta_n - \zeta_n(\zeta_n^2-6)\cos\zeta_n}{\zeta_n^4}
\end{align*}

Thus our $Z$ function is

\begin{equation}
    Z(\zeta_n) = \left[1  - \left(\frac{G}{6} + \frac{G}{3\Bi}\right)\right]C_n + \frac{G}{6}K_n
\end{equation}

The homogeneous solution is then written in a compact form as,

\begin{equation}\label{eq:transformed-transient-solution}
    U_h(\rho,\tau) = \sum_{n=1}^\infty \exp(-\zeta^2 \tau) \sin(\zeta_n \rho) \frac{Z(\zeta_n)}{N(\zeta_n)} 
\end{equation}

The complete solution is then a superposition of Eq.~\ref{eq:transformed-steady-state-solution} and Eq.~\ref{eq:transformed-transient-solution},

\begin{equation}
    U(\rho,\tau) = \left(\frac{G}{6} + \frac{G}{3\Bi}-\rho^2\right)\rho  +   \sum_{n=1}^\infty \exp(-\zeta^2 \tau) \sin(\zeta_n \rho) \frac{Z(\zeta_n)}{N(\zeta_n)} 
\end{equation}

We now transform back to our dimensionless temperature,

\begin{equation}\label{eq:temperature-solution}
    \theta(\rho,\tau) = \left(\frac{G}{6} + \frac{G}{3\Bi}-\rho^2\right)  +   \sum_{n=1}^\infty \exp(-\zeta^2 \tau) \frac{\sin(\zeta_n \rho)}{\rho} \frac{Z(\zeta_n)}{N(\zeta_n)}  
\end{equation}


\subsection{Energy}

We will want to compare the solution of Eq.~\ref{eq:temperature-solution} to that of a sphere with the lumped capacitance assumption. To facilitate comparison, we look to a measure of the energy of the sphere (with radial dependence removed via integration of Eq.~\ref{eq:temperature-solution}). The energy will be nondimensionalized as,

\begin{equation}
    E^*(\tau)=\frac{E(\tau)}{E_0}
\end{equation}

where $E_0$ is the initial energy of the sphere,

\begin{equation}
    E_0=\rho_rC_rV\mathbb{T}_0
\end{equation}

Thus the nondimensional energy of the sphere at a given time, $\tau$ is

\begin{align}
    E^*(\tau) &=\int\frac{\rho_rC_r\mathbb{T}(\rho,\tau)\mathrm{d}V}{\rho_rC_rV\mathbb{T}_0} \nonumber\\
    E^*(\tau) &=\frac{1}{V}\int \theta(\rho,\tau) \,\mathrm{d}V
\end{align}


For a circle in spherical coordinates:

\begin{equation}
    \mathrm{d}V=r^2\sin(\phi)\mathrm{d}r\mathrm{d}\phi \mathrm{d}\theta
\end{equation}

For our sphere, this becomes:

\begin{equation}
    \mathrm{d}V=4\pi b^3 \rho^{2}\mathrm{d}\rho = 3V \rho^{2}\mathrm{d}\rho
\end{equation}

The integral for dimensionless energy of our sphere is then,

\begin{equation}
    E=3\int_0^1  \left[ \frac{G}{6}\left(1 + \frac{2}{\Bi}-\rho^2\right)  +   \sum_{n=1}^\infty \exp(-\zeta^2 \tau) \frac{\sin(\zeta_n \rho)}{\rho} \frac{Z(\zeta_n)}{N(\zeta_n)}  \right] \rho^{2}\,\mathrm{d}\rho
\end{equation}

This ultimately reduces to,

% \begin{equation}
%     E^*_{t.g.}=    3\left\{ \frac{G}{6}\left(1+\frac{2}{Bi}\right)\int_0^1 \rho^{2}\,\mathrm{d}\rho - \frac{G}{6}\int_0^1 \rho^{4}\,\mathrm{d}\rho  +   \sum_{n=1}^\infty \exp(-\zeta^2 \tau) \frac{Z(\zeta_n)}{N(\zeta_n)} \int_0^1 \sin(\zeta_n \rho) \rho\,\mathrm{d}\rho\right\}
% \end{equation}

% The first two integrals are simply $\frac{1}{3}$ and $\frac{1}{5}$, respectively. We recognize the last integral as one which we solved previously. Thus,

\begin{equation}
\label{eq:energy-exact}
    E^*=\left(\frac{G}{15}+\frac{G}{3\Bi}\right)+3\sum_{n=1}^\infty \exp(-\zeta^2 \tau) \frac{Z(\zeta_n)}{N(\zeta_n)} C_n(\zeta_n)
\end{equation}


